{"failedCount":1,"prefixedPath":"classpath:features\/update-excel-data.feature","packageQualifiedName":"features.update-excel-data","loopIndex":-1,"relativePath":"features\/update-excel-data.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":38270100,"errorMessage":"js failed:\n>>>>\n01: karate.call('classpath:utils\/update-login-data.js')\n<<<<\norg.graalvm.polyglot.PolyglotException: js failed:\n>>>>\n01: (function updateLoginData() {\n02:     var FileInputStream = Java.type('java.io.FileInputStream');\n03:     var FileOutputStream = Java.type('java.io.FileOutputStream');\n04:     var XSSFWorkbook = Java.type('org.apache.poi.xssf.usermodel.XSSFWorkbook');\n05:     var File = Java.type('java.io.File');\n06: \n07:     try {\n08:         var filePath = 'src\/test\/java\/data\/data.xlsx';\n09:         var file = new File(filePath);\n10:         var workbook;\n11: \n12:         \/\/ Mở file Excel hiện có\n13:         if (file.exists()) {\n14:             var fis = new FileInputStream(file);\n15:             workbook = new XSSFWorkbook(fis);\n16:             fis.close();\n17:         } else {\n18:             karate.log('File không tồn tại: ' + filePath);\n19:             return false;\n20:         }\n21: \n22:         \/\/ Tạo hoặc lấy sheet \"login\"\n23:         var loginSheet = workbook.getSheet('login');\n24:         if (!loginSheet) {\n25:             loginSheet = workbook.createSheet('login');\n26:         }\n27: \n28:         \/\/ Xóa tất cả dữ liệu hiện có (trừ header)\n29:         var lastRowNum = loginSheet.getLastRowNum();\n30:         for (var i = lastRowNum; i >= 1; i--) {\n31:             var row = loginSheet.getRow(i);\n32:             if (row != null) {\n33:                 loginSheet.removeRow(row);\n34:             }\n35:         }\n36: \n37:         \/\/ Tạo header row nếu chưa có\n38:         var headerRow = loginSheet.getRow(0);\n39:         if (!headerRow) {\n40:             headerRow = loginSheet.createRow(0);\n41:         }\n42:         var headers = ['email', 'password', 'expectedStatus', 'expectedResult', 'testDescription', 'responseStatus', 'result'];\n43: \n44:         for (var i = 0; i < headers.length; i++) {\n45:             var cell = headerRow.getCell(i);\n46:             if (!cell) {\n47:                 cell = headerRow.createCell(i);\n48:             }\n49:             cell.setCellValue(headers[i]);\n50:         }\n51: \n52:         \/\/ Dữ liệu đăng nhập mới theo yêu cầu\n53:         var loginData = [\n54:             {\n55:                 email: 'nam@gmail.com',\n56:                 password: '123456',\n57:                 expectedStatus: 200,\n58:                 expectedResult: 'success',\n59:                 testDescription: 'Valid login credentials - Nam account'\n60:             },\n61:             {\n62:                 email: 'nam@gmail.com',\n63:                 password: '',\n64:                 expectedStatus: 400,\n65:                 expectedResult: 'Missing password',\n66:                 testDescription: 'Login without password - Nam account'\n67:             },\n68:             {\n69:                 email: 'invalid@gmail.com',\n70:                 password: '123456',\n71:                 expectedStatus: 400,\n72:                 expectedResult: 'user not found',\n73:                 testDescription: 'Login with invalid email'\n74:             },\n75:             {\n76:                 email: '',\n77:                 password: '123456',\n78:                 expectedStatus: 400,\n79:                 expectedResult: 'Missing email or username',\n80:                 testDescription: 'Login without email'\n81:             },\n82:             {\n83:                 email: 'nam@gmail.com',\n84:                 password: 'wrongpassword',\n85:                 expectedStatus: 400,\n86:                 expectedResult: 'user not found',\n87:                 testDescription: 'Login with wrong password - Nam account'\n88:             },\n89:             {\n90:                 email: 'admin@gmail.com',\n91:                 password: 'admin123',\n92:                 expectedStatus: 200,\n93:                 expectedResult: 'success',\n94:                 testDescription: 'Valid login credentials - Admin account'\n95:             },\n96:             {\n97:                 email: 'user@gmail.com',\n98:                 password: 'user123',\n99:                 expectedStatus: 200,\n100:                 expectedResult: 'success',\n101:                 testDescription: 'Valid login credentials - User account'\n102:             },\n103:             {\n104:                 email: 'test@gmail.com',\n105:                 password: 'test123',\n106:                 expectedStatus: 200,\n107:                 expectedResult: 'success',\n108:                 testDescription: 'Valid login credentials - Test account'\n109:             },\n110:             {\n111:                 email: 'user@',\n112:                 password: '123456',\n113:                 expectedStatus: 400,\n114:                 expectedResult: 'Invalid email format',\n115:                 testDescription: 'TC: Email không hợp lệ - thiếu domain'\n116:             },\n117:             {\n118:                 email: 'user.gmail.com',\n119:                 password: '123456',\n120:                 expectedStatus: 400,\n121:                 expectedResult: 'Invalid email format',\n122:                 testDescription: 'TC: Email không hợp lệ - thiếu ký tự @'\n123:             },\n124:             {\n125:                 email: '@gmail.com',\n126:                 password: '123456',\n127:                 expectedStatus: 400,\n128:                 expectedResult: 'Invalid email format',\n129:                 testDescription: 'TC: Email không hợp lệ - thiếu phần username'\n130:             },\n131:             {\n132:                 email: 'nam@gmail.com',\n133:                 password: '12',\n134:                 expectedStatus: 400,\n135:                 expectedResult: 'Password must be between 6 and 20 characters',\n136:                 testDescription: 'TC: Password quá ngắn'\n137:             },\n138:             {\n139:                 email: 'nam@gmail.com',\n140:                 password: 'verylongpasswordthatexceedsthenormallimitsforpasswordlength123456789',\n141:                 expectedStatus: 400,\n142:                 expectedResult: 'Password must be between 6 and 20 characters',\n143:                 testDescription: 'TC: Password quá dài'\n144:             },\n145:             {\n146:                 email: \"' OR '1'='1\",\n147:                 password: '123456',\n148:                 expectedStatus: 400,\n149:                 expectedResult: 'Invalid input',\n150:                 testDescription: 'TC: SQL Injection trong email'\n151:             },\n152:             {\n153:                 email: 'nam@gmail.com',\n154:                 password: \"' OR '1'='1\",\n155:                 expectedStatus: 400,\n156:                 expectedResult: 'Invalid input',\n157:                 testDescription: 'TC: SQL Injection trong password'\n158:             },\n159:             {\n160:                 email: '<script>alert(\"xss\")<\/script>@gmail.com',\n161:                 password: '123456',\n162:                 expectedStatus: 400,\n163:                 expectedResult: 'Invalid input',\n164:                 testDescription: 'TC: XSS trong email'\n165:             },\n166:             {\n167:                 email: 'nam@gmail.com',\n168:                 password: '<script>alert(\"xss\")<\/script>',\n169:                 expectedStatus: 400,\n170:                 expectedResult: 'Invalid input',\n171:                 testDescription: 'TC: XSS trong password'\n172:             }\n173:         ];\n174: \n175:         \/\/ Thêm dữ liệu vào sheet\n176:         for (var i = 0; i < loginData.length; i++) {\n177:             var row = loginSheet.createRow(i + 1);\n178:             var data = loginData[i];\n179: \n180:             row.createCell(0).setCellValue(data.email);\n181:             row.createCell(1).setCellValue(data.password);\n182:             row.createCell(2).setCellValue(data.expectedStatus);\n183:             row.createCell(3).setCellValue(data.expectedResult);\n184:             row.createCell(4).setCellValue(data.testDescription);\n185:             row.createCell(5).setCellValue(''); \/\/ responseStatus - sẽ được điền sau\n186:             row.createCell(6).setCellValue(''); \/\/ result - sẽ được điền sau\n187:         }\n188: \n189:         \/\/ Lưu file\n190:         var fos = new FileOutputStream(file);\n191:         workbook.write(fos);\n192:         fos.close();\n193:         workbook.close();\n194: \n195:         karate.log('Đã cập nhật dữ liệu đăng nhập trong file Excel thành công!');\n196:         karate.log('Dữ liệu login chính: nam@gmail.com \/ 123456');\n197:         karate.log('Tổng số test cases: ' + loginData.length);\n198: \n199:         return true;\n200: \n201:     } catch (e) {\n202:         karate.log('Lỗi khi cập nhật Excel: ' + e.message);\n203:         return false;\n204:     }\n205: }\n206: \n207: \/\/ Gọi function\n208: updateLoginData(); )\n<<<<\norg.graalvm.polyglot.PolyglotException: SyntaxError: Unnamed:208:0 Expected ) but found updateLoginData\r\nupdateLoginData(); )\r\n^\nUnnamed:208:19 Expected ; but found )\r\nupdateLoginData(); )\r\n                   ^\n\n- org.graalvm.polyglot.Context.eval(Context.java:425)\n- com.intuit.karate.graal.JsEngine.evalForValue(JsEngine.java:169)\n- com.intuit.karate.graal.JsEngine.eval(JsEngine.java:165)\n- com.intuit.karate.core.ScenarioEngine.evalJs(ScenarioEngine.java:1286)\n- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:59)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:164)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:151)\n\n- com.intuit.karate.graal.JsEngine.fromJsEvalException(JsEngine.java:253)\n- com.intuit.karate.core.ScenarioEngine.evalJs(ScenarioEngine.java:1288)\n- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:59)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:164)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:151)\n- <js>.:program(Unnamed:1)\n\nclasspath:features\/update-excel-data.feature:4","startTime":1750148019962,"endTime":1750148020000,"millis":38.2701,"status":"failed"},"step":{"line":4,"prefix":"*","index":0,"text":"karate.call('classpath:utils\/update-login-data.js')"},"stepLog":"15:13:39.928 karate.env system property was: null \n15:13:40.006 classpath:features\/update-excel-data.feature:4\n* karate.call('classpath:utils\/update-login-data.js')\njs failed:\n>>>>\n01: karate.call('classpath:utils\/update-login-data.js')\n<<<<\norg.graalvm.polyglot.PolyglotException: js failed:\n>>>>\n01: (function updateLoginData() {\n02:     var FileInputStream = Java.type('java.io.FileInputStream');\n03:     var FileOutputStream = Java.type('java.io.FileOutputStream');\n04:     var XSSFWorkbook = Java.type('org.apache.poi.xssf.usermodel.XSSFWorkbook');\n05:     var File = Java.type('java.io.File');\n06: \n07:     try {\n08:         var filePath = 'src\/test\/java\/data\/data.xlsx';\n09:         var file = new File(filePath);\n10:         var workbook;\n11: \n12:         \/\/ Mở file Excel hiện có\n13:         if (file.exists()) {\n14:             var fis = new FileInputStream(file);\n15:             workbook = new XSSFWorkbook(fis);\n16:             fis.close();\n17:         } else {\n18:             karate.log('File không tồn tại: ' + filePath);\n19:             return false;\n20:         }\n21: \n22:         \/\/ Tạo hoặc lấy sheet \"login\"\n23:         var loginSheet = workbook.getSheet('login');\n24:         if (!loginSheet) {\n25:             loginSheet = workbook.createSheet('login');\n26:         }\n27: \n28:         \/\/ Xóa tất cả dữ liệu hiện có (trừ header)\n29:         var lastRowNum = loginSheet.getLastRowNum();\n30:         for (var i = lastRowNum; i >= 1; i--) {\n31:             var row = loginSheet.getRow(i);\n32:             if (row != null) {\n33:                 loginSheet.removeRow(row);\n34:             }\n35:         }\n36: \n37:         \/\/ Tạo header row nếu chưa có\n38:         var headerRow = loginSheet.getRow(0);\n39:         if (!headerRow) {\n40:             headerRow = loginSheet.createRow(0);\n41:         }\n42:         var headers = ['email', 'password', 'expectedStatus', 'expectedResult', 'testDescription', 'responseStatus', 'result'];\n43: \n44:         for (var i = 0; i < headers.length; i++) {\n45:             var cell = headerRow.getCell(i);\n46:             if (!cell) {\n47:                 cell = headerRow.createCell(i);\n48:             }\n49:             cell.setCellValue(headers[i]);\n50:         }\n51: \n52:         \/\/ Dữ liệu đăng nhập mới theo yêu cầu\n53:         var loginData = [\n54:             {\n55:                 email: 'nam@gmail.com',\n56:                 password: '123456',\n57:                 expectedStatus: 200,\n58:                 expectedResult: 'success',\n59:                 testDescription: 'Valid login credentials - Nam account'\n60:             },\n61:             {\n62:                 email: 'nam@gmail.com',\n63:                 password: '',\n64:                 expectedStatus: 400,\n65:                 expectedResult: 'Missing password',\n66:                 testDescription: 'Login without password - Nam account'\n67:             },\n68:             {\n69:                 email: 'invalid@gmail.com',\n70:                 password: '123456',\n71:                 expectedStatus: 400,\n72:                 expectedResult: 'user not found',\n73:                 testDescription: 'Login with invalid email'\n74:             },\n75:             {\n76:                 email: '',\n77:                 password: '123456',\n78:                 expectedStatus: 400,\n79:                 expectedResult: 'Missing email or username',\n80:                 testDescription: 'Login without email'\n81:             },\n82:             {\n83:                 email: 'nam@gmail.com',\n84:                 password: 'wrongpassword',\n85:                 expectedStatus: 400,\n86:                 expectedResult: 'user not found',\n87:                 testDescription: 'Login with wrong password - Nam account'\n88:             },\n89:             {\n90:                 email: 'admin@gmail.com',\n91:                 password: 'admin123',\n92:                 expectedStatus: 200,\n93:                 expectedResult: 'success',\n94:                 testDescription: 'Valid login credentials - Admin account'\n95:             },\n96:             {\n97:                 email: 'user@gmail.com',\n98:                 password: 'user123',\n99:                 expectedStatus: 200,\n100:                 expectedResult: 'success',\n101:                 testDescription: 'Valid login credentials - User account'\n102:             },\n103:             {\n104:                 email: 'test@gmail.com',\n105:                 password: 'test123',\n106:                 expectedStatus: 200,\n107:                 expectedResult: 'success',\n108:                 testDescription: 'Valid login credentials - Test account'\n109:             },\n110:             {\n111:                 email: 'user@',\n112:                 password: '123456',\n113:                 expectedStatus: 400,\n114:                 expectedResult: 'Invalid email format',\n115:                 testDescription: 'TC: Email không hợp lệ - thiếu domain'\n116:             },\n117:             {\n118:                 email: 'user.gmail.com',\n119:                 password: '123456',\n120:                 expectedStatus: 400,\n121:                 expectedResult: 'Invalid email format',\n122:                 testDescription: 'TC: Email không hợp lệ - thiếu ký tự @'\n123:             },\n124:             {\n125:                 email: '@gmail.com',\n126:                 password: '123456',\n127:                 expectedStatus: 400,\n128:                 expectedResult: 'Invalid email format',\n129:                 testDescription: 'TC: Email không hợp lệ - thiếu phần username'\n130:             },\n131:             {\n132:                 email: 'nam@gmail.com',\n133:                 password: '12',\n134:                 expectedStatus: 400,\n135:                 expectedResult: 'Password must be between 6 and 20 characters',\n136:                 testDescription: 'TC: Password quá ngắn'\n137:             },\n138:             {\n139:                 email: 'nam@gmail.com',\n140:                 password: 'verylongpasswordthatexceedsthenormallimitsforpasswordlength123456789',\n141:                 expectedStatus: 400,\n142:                 expectedResult: 'Password must be between 6 and 20 characters',\n143:                 testDescription: 'TC: Password quá dài'\n144:             },\n145:             {\n146:                 email: \"' OR '1'='1\",\n147:                 password: '123456',\n148:                 expectedStatus: 400,\n149:                 expectedResult: 'Invalid input',\n150:                 testDescription: 'TC: SQL Injection trong email'\n151:             },\n152:             {\n153:                 email: 'nam@gmail.com',\n154:                 password: \"' OR '1'='1\",\n155:                 expectedStatus: 400,\n156:                 expectedResult: 'Invalid input',\n157:                 testDescription: 'TC: SQL Injection trong password'\n158:             },\n159:             {\n160:                 email: '<script>alert(\"xss\")<\/script>@gmail.com',\n161:                 password: '123456',\n162:                 expectedStatus: 400,\n163:                 expectedResult: 'Invalid input',\n164:                 testDescription: 'TC: XSS trong email'\n165:             },\n166:             {\n167:                 email: 'nam@gmail.com',\n168:                 password: '<script>alert(\"xss\")<\/script>',\n169:                 expectedStatus: 400,\n170:                 expectedResult: 'Invalid input',\n171:                 testDescription: 'TC: XSS trong password'\n172:             }\n173:         ];\n174: \n175:         \/\/ Thêm dữ liệu vào sheet\n176:         for (var i = 0; i < loginData.length; i++) {\n177:             var row = loginSheet.createRow(i + 1);\n178:             var data = loginData[i];\n179: \n180:             row.createCell(0).setCellValue(data.email);\n181:             row.createCell(1).setCellValue(data.password);\n182:             row.createCell(2).setCellValue(data.expectedStatus);\n183:             row.createCell(3).setCellValue(data.expectedResult);\n184:             row.createCell(4).setCellValue(data.testDescription);\n185:             row.createCell(5).setCellValue(''); \/\/ responseStatus - sẽ được điền sau\n186:             row.createCell(6).setCellValue(''); \/\/ result - sẽ được điền sau\n187:         }\n188: \n189:         \/\/ Lưu file\n190:         var fos = new FileOutputStream(file);\n191:         workbook.write(fos);\n192:         fos.close();\n193:         workbook.close();\n194: \n195:         karate.log('Đã cập nhật dữ liệu đăng nhập trong file Excel thành công!');\n196:         karate.log('Dữ liệu login chính: nam@gmail.com \/ 123456');\n197:         karate.log('Tổng số test cases: ' + loginData.length);\n198: \n199:         return true;\n200: \n201:     } catch (e) {\n202:         karate.log('Lỗi khi cập nhật Excel: ' + e.message);\n203:         return false;\n204:     }\n205: }\n206: \n207: \/\/ Gọi function\n208: updateLoginData(); )\n<<<<\norg.graalvm.polyglot.PolyglotException: SyntaxError: Unnamed:208:0 Expected ) but found updateLoginData\r\nupdateLoginData(); )\r\n^\nUnnamed:208:19 Expected ; but found )\r\nupdateLoginData(); )\r\n                   ^\n\n- org.graalvm.polyglot.Context.eval(Context.java:425)\n- com.intuit.karate.graal.JsEngine.evalForValue(JsEngine.java:169)\n- com.intuit.karate.graal.JsEngine.eval(JsEngine.java:165)\n- com.intuit.karate.core.ScenarioEngine.evalJs(ScenarioEngine.java:1286)\n- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:59)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:164)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:151)\n\n- com.intuit.karate.graal.JsEngine.fromJsEvalException(JsEngine.java:253)\n- com.intuit.karate.core.ScenarioEngine.evalJs(ScenarioEngine.java:1288)\n- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:59)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:164)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:151)\n- <js>.:program(Unnamed:1)\n\nclasspath:features\/update-excel-data.feature:4\n"},{"result":{"nanos":0,"startTime":1750148020006,"endTime":1750148020006,"millis":0.0,"status":"skipped"},"step":{"line":5,"prefix":"*","index":1,"text":"print 'Đã hoàn thành cập nhật dữ liệu đăng nhập trong file Excel'"}}],"line":3,"description":"","durationMillis":38.2701,"failed":true,"error":"js failed:\n>>>>\n01: karate.call('classpath:utils\/update-login-data.js')\n<<<<\norg.graalvm.polyglot.PolyglotException: js failed:\n>>>>\n01: (function updateLoginData() {\n02:     var FileInputStream = Java.type('java.io.FileInputStream');\n03:     var FileOutputStream = Java.type('java.io.FileOutputStream');\n04:     var XSSFWorkbook = Java.type('org.apache.poi.xssf.usermodel.XSSFWorkbook');\n05:     var File = Java.type('java.io.File');\n06: \n07:     try {\n08:         var filePath = 'src\/test\/java\/data\/data.xlsx';\n09:         var file = new File(filePath);\n10:         var workbook;\n11: \n12:         \/\/ Mở file Excel hiện có\n13:         if (file.exists()) {\n14:             var fis = new FileInputStream(file);\n15:             workbook = new XSSFWorkbook(fis);\n16:             fis.close();\n17:         } else {\n18:             karate.log('File không tồn tại: ' + filePath);\n19:             return false;\n20:         }\n21: \n22:         \/\/ Tạo hoặc lấy sheet \"login\"\n23:         var loginSheet = workbook.getSheet('login');\n24:         if (!loginSheet) {\n25:             loginSheet = workbook.createSheet('login');\n26:         }\n27: \n28:         \/\/ Xóa tất cả dữ liệu hiện có (trừ header)\n29:         var lastRowNum = loginSheet.getLastRowNum();\n30:         for (var i = lastRowNum; i >= 1; i--) {\n31:             var row = loginSheet.getRow(i);\n32:             if (row != null) {\n33:                 loginSheet.removeRow(row);\n34:             }\n35:         }\n36: \n37:         \/\/ Tạo header row nếu chưa có\n38:         var headerRow = loginSheet.getRow(0);\n39:         if (!headerRow) {\n40:             headerRow = loginSheet.createRow(0);\n41:         }\n42:         var headers = ['email', 'password', 'expectedStatus', 'expectedResult', 'testDescription', 'responseStatus', 'result'];\n43: \n44:         for (var i = 0; i < headers.length; i++) {\n45:             var cell = headerRow.getCell(i);\n46:             if (!cell) {\n47:                 cell = headerRow.createCell(i);\n48:             }\n49:             cell.setCellValue(headers[i]);\n50:         }\n51: \n52:         \/\/ Dữ liệu đăng nhập mới theo yêu cầu\n53:         var loginData = [\n54:             {\n55:                 email: 'nam@gmail.com',\n56:                 password: '123456',\n57:                 expectedStatus: 200,\n58:                 expectedResult: 'success',\n59:                 testDescription: 'Valid login credentials - Nam account'\n60:             },\n61:             {\n62:                 email: 'nam@gmail.com',\n63:                 password: '',\n64:                 expectedStatus: 400,\n65:                 expectedResult: 'Missing password',\n66:                 testDescription: 'Login without password - Nam account'\n67:             },\n68:             {\n69:                 email: 'invalid@gmail.com',\n70:                 password: '123456',\n71:                 expectedStatus: 400,\n72:                 expectedResult: 'user not found',\n73:                 testDescription: 'Login with invalid email'\n74:             },\n75:             {\n76:                 email: '',\n77:                 password: '123456',\n78:                 expectedStatus: 400,\n79:                 expectedResult: 'Missing email or username',\n80:                 testDescription: 'Login without email'\n81:             },\n82:             {\n83:                 email: 'nam@gmail.com',\n84:                 password: 'wrongpassword',\n85:                 expectedStatus: 400,\n86:                 expectedResult: 'user not found',\n87:                 testDescription: 'Login with wrong password - Nam account'\n88:             },\n89:             {\n90:                 email: 'admin@gmail.com',\n91:                 password: 'admin123',\n92:                 expectedStatus: 200,\n93:                 expectedResult: 'success',\n94:                 testDescription: 'Valid login credentials - Admin account'\n95:             },\n96:             {\n97:                 email: 'user@gmail.com',\n98:                 password: 'user123',\n99:                 expectedStatus: 200,\n100:                 expectedResult: 'success',\n101:                 testDescription: 'Valid login credentials - User account'\n102:             },\n103:             {\n104:                 email: 'test@gmail.com',\n105:                 password: 'test123',\n106:                 expectedStatus: 200,\n107:                 expectedResult: 'success',\n108:                 testDescription: 'Valid login credentials - Test account'\n109:             },\n110:             {\n111:                 email: 'user@',\n112:                 password: '123456',\n113:                 expectedStatus: 400,\n114:                 expectedResult: 'Invalid email format',\n115:                 testDescription: 'TC: Email không hợp lệ - thiếu domain'\n116:             },\n117:             {\n118:                 email: 'user.gmail.com',\n119:                 password: '123456',\n120:                 expectedStatus: 400,\n121:                 expectedResult: 'Invalid email format',\n122:                 testDescription: 'TC: Email không hợp lệ - thiếu ký tự @'\n123:             },\n124:             {\n125:                 email: '@gmail.com',\n126:                 password: '123456',\n127:                 expectedStatus: 400,\n128:                 expectedResult: 'Invalid email format',\n129:                 testDescription: 'TC: Email không hợp lệ - thiếu phần username'\n130:             },\n131:             {\n132:                 email: 'nam@gmail.com',\n133:                 password: '12',\n134:                 expectedStatus: 400,\n135:                 expectedResult: 'Password must be between 6 and 20 characters',\n136:                 testDescription: 'TC: Password quá ngắn'\n137:             },\n138:             {\n139:                 email: 'nam@gmail.com',\n140:                 password: 'verylongpasswordthatexceedsthenormallimitsforpasswordlength123456789',\n141:                 expectedStatus: 400,\n142:                 expectedResult: 'Password must be between 6 and 20 characters',\n143:                 testDescription: 'TC: Password quá dài'\n144:             },\n145:             {\n146:                 email: \"' OR '1'='1\",\n147:                 password: '123456',\n148:                 expectedStatus: 400,\n149:                 expectedResult: 'Invalid input',\n150:                 testDescription: 'TC: SQL Injection trong email'\n151:             },\n152:             {\n153:                 email: 'nam@gmail.com',\n154:                 password: \"' OR '1'='1\",\n155:                 expectedStatus: 400,\n156:                 expectedResult: 'Invalid input',\n157:                 testDescription: 'TC: SQL Injection trong password'\n158:             },\n159:             {\n160:                 email: '<script>alert(\"xss\")<\/script>@gmail.com',\n161:                 password: '123456',\n162:                 expectedStatus: 400,\n163:                 expectedResult: 'Invalid input',\n164:                 testDescription: 'TC: XSS trong email'\n165:             },\n166:             {\n167:                 email: 'nam@gmail.com',\n168:                 password: '<script>alert(\"xss\")<\/script>',\n169:                 expectedStatus: 400,\n170:                 expectedResult: 'Invalid input',\n171:                 testDescription: 'TC: XSS trong password'\n172:             }\n173:         ];\n174: \n175:         \/\/ Thêm dữ liệu vào sheet\n176:         for (var i = 0; i < loginData.length; i++) {\n177:             var row = loginSheet.createRow(i + 1);\n178:             var data = loginData[i];\n179: \n180:             row.createCell(0).setCellValue(data.email);\n181:             row.createCell(1).setCellValue(data.password);\n182:             row.createCell(2).setCellValue(data.expectedStatus);\n183:             row.createCell(3).setCellValue(data.expectedResult);\n184:             row.createCell(4).setCellValue(data.testDescription);\n185:             row.createCell(5).setCellValue(''); \/\/ responseStatus - sẽ được điền sau\n186:             row.createCell(6).setCellValue(''); \/\/ result - sẽ được điền sau\n187:         }\n188: \n189:         \/\/ Lưu file\n190:         var fos = new FileOutputStream(file);\n191:         workbook.write(fos);\n192:         fos.close();\n193:         workbook.close();\n194: \n195:         karate.log('Đã cập nhật dữ liệu đăng nhập trong file Excel thành công!');\n196:         karate.log('Dữ liệu login chính: nam@gmail.com \/ 123456');\n197:         karate.log('Tổng số test cases: ' + loginData.length);\n198: \n199:         return true;\n200: \n201:     } catch (e) {\n202:         karate.log('Lỗi khi cập nhật Excel: ' + e.message);\n203:         return false;\n204:     }\n205: }\n206: \n207: \/\/ Gọi function\n208: updateLoginData(); )\n<<<<\norg.graalvm.polyglot.PolyglotException: SyntaxError: Unnamed:208:0 Expected ) but found updateLoginData\r\nupdateLoginData(); )\r\n^\nUnnamed:208:19 Expected ; but found )\r\nupdateLoginData(); )\r\n                   ^\n\n- org.graalvm.polyglot.Context.eval(Context.java:425)\n- com.intuit.karate.graal.JsEngine.evalForValue(JsEngine.java:169)\n- com.intuit.karate.graal.JsEngine.eval(JsEngine.java:165)\n- com.intuit.karate.core.ScenarioEngine.evalJs(ScenarioEngine.java:1286)\n- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:59)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:164)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:151)\n\n- com.intuit.karate.graal.JsEngine.fromJsEvalException(JsEngine.java:253)\n- com.intuit.karate.core.ScenarioEngine.evalJs(ScenarioEngine.java:1288)\n- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:59)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:164)\n- com.intuit.karate.core.ScenarioBridge.call(ScenarioBridge.java:151)\n- <js>.:program(Unnamed:1)\n\nclasspath:features\/update-excel-data.feature:4","executorName":"main","name":"Cập nhật dữ liệu login trong file data.xlsx","startTime":1750148019802,"refId":"[1:3]","endTime":1750148020006,"exampleIndex":-1}],"callDepth":0,"name":"Cập nhật dữ liệu đăng nhập trong Excel","description":"","resultDate":"2025-06-17 03:13:40 PM","durationMillis":38.2701,"passedCount":0}